# AI 꿈해석 로또번호 추천 웹 서비스 개발 규칙

## 1. 프로젝트 개요

이 프로젝트는 Next.js 15 App Router 기반의 AI 꿈해석 로또번호 추천 웹 서비스입니다.

### 핵심 원칙
- **사용자 경험 최우선**: 모든 화면에서 로딩 상태, 빈 상태, 오류 상태 UI를 제공하고, 상호작용 지연을 최소화합니다.
- **오류 처리 철저**: 서버와 클라이언트 모두에서 예외를 포착하고, 사용자에게는 한글로 친절한 메시지를 제공합니다. 개발 환경에서는 상세한 로그를 출력합니다.

## 2. 기술 스택

### 필수 기술
- **Next.js 15** (App Router 사용)
- **TypeScript** (strict 모드 사용)
- **Tailwind CSS** (스타일링)
- **Shadcn/ui** (UI 컴포넌트 라이브러리)
- **Supabase** (인증 및 데이터베이스)
- **AI SDK** (AI 모델 연동)
- **ESLint** (Next.js 및 TypeScript 규칙 기반)

### 의존성 관리
- `package.json`에 명시된 버전을 준수합니다.
- 새로운 패키지 추가 시 반드시 타입 정의를 확인합니다.

## 3. 코딩 스타일 및 컨벤션

### 컴포넌트 작성 규칙
- **함수형 컴포넌트를 기본으로 사용**합니다.
- **모든 함수는 화살표 함수로 작성**합니다.
- **컴포넌트 파일명은 파스칼 케이스**로 저장합니다 (예: `TodoList.tsx`, `DreamAnalyzer.tsx`).

### 주석 및 문서화
- **한글 주석 필수**: 모든 함수 및 컴포넌트 상단에 한 문장 개요를 한글로 작성합니다.
- **JSDoc은 한글로 기술**합니다.
- 복잡한 로직은 단계별로 한글 주석을 추가합니다.

### 예시
```typescript
/**
 * 꿈 내용을 분석하여 로또 번호를 추천하는 컴포넌트
 * @param dreamText - 사용자가 입력한 꿈 내용
 * @returns 추천된 로또 번호 배열
 */
const DreamAnalyzer = ({ dreamText }: { dreamText: string }) => {
  // 꿈 텍스트를 AI 모델에 전달하여 분석
  const analyzeDream = async () => {
    // AI 모델 호출 로직
  };

  return (
    <div>
      {/* 컴포넌트 JSX */}
    </div>
  );
};
```

## 4. 파일 구조 및 네이밍

### 디렉토리 구조
```
app/              # Next.js App Router 페이지 및 라우트
components/       # 재사용 가능한 컴포넌트
  ui/            # Shadcn/ui 컴포넌트
lib/             # 유틸리티 함수 및 헬퍼
types/           # TypeScript 타입 정의
hooks/           # 커스텀 React 훅
```

### 네이밍 규칙
- **컴포넌트 파일**: 파스칼 케이스 사용 (예: `DreamAnalyzer.tsx`)
- **유틸리티 파일**: 케밥 케이스 사용 (예: `dream-utils.ts`)
- **타입 파일**: 케밥 케이스 사용 (예: `dream-types.ts`)
- **훅 파일**: 케밥 케이스 사용 (예: `use-dream-analysis.ts`)

## 5. 사용자 경험 (UX) 가이드라인

### 상태 관리
모든 비동기 작업에 대해 다음 상태를 고려합니다:

1. **로딩 상태 (Loading)**
   - 데이터를 불러오는 동안 로딩 스피너 또는 스켈레톤 UI를 표시합니다.
   - 사용자에게 진행 상황을 명확히 알립니다.

2. **빈 상태 (Empty)**
   - 데이터가 없을 때 친절한 안내 메시지를 표시합니다.
   - 사용자가 다음 행동을 취할 수 있도록 명확한 CTA를 제공합니다.

3. **오류 상태 (Error)**
   - 오류 발생 시 한글로 친절한 메시지를 표시합니다.
   - 사용자가 재시도할 수 있는 옵션을 제공합니다.
   - 개발 환경에서는 콘솔에 상세한 오류 정보를 출력합니다.

### 상호작용 최적화
- 버튼 클릭, 폼 제출 등 사용자 액션에 즉각적인 피드백을 제공합니다.
- 불필요한 리렌더링을 방지하기 위해 `useMemo`, `useCallback`을 활용합니다.
- 이미지 및 리소스는 최적화하여 로딩 시간을 단축합니다.

## 6. 오류 처리

### 클라이언트 사이드 오류 처리
```typescript
/**
 * API 호출 시 오류를 처리하는 헬퍼 함수
 */
const handleApiError = (error: unknown) => {
  // 개발 환경에서는 상세 로그 출력
  if (process.env.NODE_ENV === 'development') {
    console.error('API 오류 상세:', error);
  }

  // 사용자에게는 친절한 한글 메시지 제공
  const userMessage = error instanceof Error 
    ? '요청 처리 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.'
    : '알 수 없는 오류가 발생했습니다.';

  return userMessage;
};
```

### 서버 사이드 오류 처리
- API 라우트에서 모든 예외를 try-catch로 포착합니다.
- 적절한 HTTP 상태 코드를 반환합니다.
- 사용자에게는 한글로 오류 메시지를 전달합니다.

## 7. TypeScript 사용 규칙

### 타입 정의
- 모든 함수의 매개변수와 반환값에 타입을 명시합니다.
- `any` 타입 사용을 최대한 지양하고, `unknown`을 우선 고려합니다.
- 공통 타입은 `types/` 디렉토리에 정의하고 재사용합니다.

### Strict 모드
- `tsconfig.json`에서 `strict: true`를 사용합니다.
- 타입 안정성을 최우선으로 고려합니다.

## 8. 스타일링 규칙

### Tailwind CSS
- 유틸리티 클래스를 우선적으로 사용합니다.
- 반복되는 스타일은 `@apply` 또는 컴포넌트로 추출합니다.
- 반응형 디자인을 고려하여 모바일 우선 접근 방식을 사용합니다.

### Shadcn/ui
- Shadcn/ui 컴포넌트를 기본으로 사용합니다.
- 필요시 `components/ui/` 디렉토리에서 컴포넌트를 커스터마이징합니다.

## 9. 코드 품질 관리

### ESLint
- Next.js 및 TypeScript ESLint 규칙을 준수합니다.
- 커밋 전에 ESLint 오류를 모두 해결합니다.

### 코드 리뷰 체크리스트
- [ ] 한글 주석이 모든 함수/컴포넌트에 포함되어 있는가?
- [ ] 로딩/빈/오류 상태 UI가 모두 구현되어 있는가?
- [ ] TypeScript 타입이 올바르게 정의되어 있는가?
- [ ] ESLint 오류가 없는가?
- [ ] 사용자에게 친절한 한글 메시지가 제공되는가?

## 10. AI 모델 연동

### AI SDK 사용
- AI SDK를 사용하여 모델과 연동합니다.
- API 키는 환경 변수로 관리하고 코드에 하드코딩하지 않습니다.
- 스트리밍 응답을 처리하여 사용자 경험을 향상시킵니다.

## 11. 데이터베이스 및 인증

### Supabase
- Supabase를 사용하여 인증 및 데이터베이스 작업을 수행합니다.
- Row Level Security (RLS) 정책을 설정합니다.
- 클라이언트 사이드에서는 Supabase 클라이언트를 통해 접근합니다.

## 12. 성능 최적화

### Next.js 최적화
- 이미지는 `next/image`를 사용합니다.
- 동적 임포트를 활용하여 코드 스플리팅을 수행합니다.
- 서버 컴포넌트를 활용하여 클라이언트 번들 크기를 줄입니다.

### 모니터링
- 개발 환경에서 성능 메트릭을 모니터링합니다.
- 불필요한 리렌더링을 방지합니다.

---

**참고**: 이 규칙은 프로젝트 진행에 따라 업데이트될 수 있습니다. 모든 팀원은 이 규칙을 준수하여 일관된 코드 품질을 유지합니다.
